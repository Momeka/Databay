#include <gb/gb.h>
#include "GameOver.h"
#include "Game.h"
#include "Utilities.h"

const unsigned char gameoverData[] = {
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x06,0x06,0x06,0x06,0x06,0x06,0x07,0x07,
0x00,0x00,0x00,0x00,0x00,0x00,0xEF,0xEF,0x0D,0x0D,0xED,0xED,0x6F,0x6F,0xED,0xED,
0x00,0x00,0x00,0x00,0x00,0x00,0xBB,0xBB,0xB5,0xB5,0xB5,0xB5,0xB1,0xB1,0xB1,0xB1,
0x00,0x00,0x00,0x00,0x00,0x00,0xBC,0xBC,0xB0,0xB0,0xB8,0xB8,0xB0,0xB0,0xBC,0xBC,
0x00,0x00,0x00,0x00,0x00,0x00,0x3E,0x3E,0x36,0x36,0x36,0x36,0x36,0x36,0x3E,0x3E,
0x00,0x00,0x00,0x00,0x00,0x00,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0xDB,0x73,0x73,
0x00,0x00,0x00,0x00,0x00,0x00,0xDF,0xDF,0x1B,0x1B,0x9B,0x9B,0x1E,0x1E,0xDB,0xDB,
0x00,0x00,0x00,0x00,0x00,0x00,0x1E,0x1E,0x18,0x18,0x1E,0x1E,0x06,0x06,0x1E,0x1E,
0x00,0x00,0x00,0x00,0x00,0x00,0xF7,0xF7,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xF7,0xF7,
0x00,0x00,0x00,0x00,0x00,0x00,0xDF,0xDF,0xDB,0xDB,0xDB,0xDB,0xDE,0xDE,0xDB,0xDB,
0x00,0x00,0x00,0x00,0x00,0x00,0x78,0x78,0x60,0x60,0x70,0x70,0x60,0x60,0x78,0x78
};

const unsigned char gameoverTiles[] = {
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x09,0x0A,0x0B,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

void Initialize_gameover(void)
{
	HIDE_SPRITES;
	HIDE_BKG;
	SPRITES_8x16;

 	SCX_REG = 0;
	set_bkg_data(0, 12, &gameoverData);
	set_bkg_tiles(0, 0, 20, 18, &gameoverTiles);

	SHOW_BKG;
	SHOW_SPRITES;
}

void Draw_score(void)
{
	Score *score = Get_score();

  	switch(score->single)
  	{
    	case 0: set_sprite_tile(0, 28); break;
    	case 1: set_sprite_tile(0, 30); break;
    	case 2: set_sprite_tile(0, 32); break;
	    case 3: set_sprite_tile(0, 34); break;
	    case 4: set_sprite_tile(0, 36); break;
	    case 5: set_sprite_tile(0, 38); break;
	    case 6: set_sprite_tile(0, 40); break;
	    case 7: set_sprite_tile(0, 42); break;
	    case 8: set_sprite_tile(0, 44); break;
	    case 9: set_sprite_tile(0, 46); break;
	}

	switch(score->tenth)
	{
	    case 0: set_sprite_tile(1, 28); break;
	    case 1: set_sprite_tile(1, 30); break;
	    case 2: set_sprite_tile(1, 32); break;
	    case 3: set_sprite_tile(1, 34); break;
	    case 4: set_sprite_tile(1, 36); break;
	    case 5: set_sprite_tile(1, 38); break;
	    case 6: set_sprite_tile(1, 40); break;
	    case 7: set_sprite_tile(1, 42); break;
	    case 8: set_sprite_tile(1, 44); break;
	    case 9: set_sprite_tile(1, 46); break;
	}

	switch(score->hundredth)
	{
	    case 0: set_sprite_tile(2, 28); break;
	    case 1: set_sprite_tile(2, 30); break;
	    case 2: set_sprite_tile(2, 32); break;
	    case 3: set_sprite_tile(2, 34); break;
	    case 4: set_sprite_tile(2, 36); break;
	    case 5: set_sprite_tile(2, 38); break;
	    case 6: set_sprite_tile(2, 40); break;
	    case 7: set_sprite_tile(2, 42); break;
	    case 8: set_sprite_tile(2, 44); break;
	    case 9: set_sprite_tile(2, 46); break;
	}

	switch(score->thousandth)
	{
	    case 0: set_sprite_tile(3, 28); break;
	    case 1: set_sprite_tile(3, 30); break;
	    case 2: set_sprite_tile(3, 32); break;
	    case 3: set_sprite_tile(3, 34); break;
	    case 4: set_sprite_tile(3, 36); break;
	    case 5: set_sprite_tile(3, 38); break;
	    case 6: set_sprite_tile(3, 40); break;
	    case 7: set_sprite_tile(3, 42); break;
	    case 8: set_sprite_tile(3, 44); break;
		case 9: set_sprite_tile(3, 46); break;
	}

  	move_sprite(3, 73, 71);
  	move_sprite(2, 81, 71);
  	move_sprite(1, 89, 71);
  	move_sprite(0, 97, 71);
}

UBYTE Run_gameover(void)
{
	Initialize_gameover();
	Fade_in();
	Draw_score();

	while(1)
	{
		Poll_joypad();

		if(Is_new_key_down(J_START | J_A | J_B))
		{
			Reset_sprites();
			Fade_out();
			return 2;
		}

		wait_vbl_done();
	}

	return 2;
}